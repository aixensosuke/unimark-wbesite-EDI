<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Records - UniMark</title>
    <link rel="icon" type="image/png" href="../../assets/images/logo.png">
    <link rel="apple-touch-icon" href="../../assets/images/logo.png">
    <link rel="stylesheet" href="../../css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- SheetJS (for Excel export) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Custom Cursor -->
    <div class="cursor"></div>

    <!-- Header -->
    <div id="header"></div>

    <!-- Sidebar -->
    <div id="slider"></div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay"></div>

    <main>
        <div class="attendance-history-container">
            <h2><i class="fas fa-clipboard-check"></i>Attendance Records</h2>
            
            <div class="filter-tools">
                <div class="filter-group">
                    <label class="filter-label" for="session-filter">Session</label>
                    <select id="session-filter">
                        <option value="all">All Sessions</option>
                        <!-- Session options will be populated dynamically -->
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label" for="date-filter">Date Range</label>
                    <select id="date-filter">
                        <option value="all">All Time</option>
                        <option value="today">Today</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>
                
                <div class="filter-group" id="date-range-container" style="display: none;">
                    <label class="filter-label" for="date-start">From</label>
                    <input type="date" id="date-start">
                </div>
                
                <div class="filter-group" id="date-range-end-container" style="display: none;">
                    <label class="filter-label" for="date-end">To</label>
                    <input type="date" id="date-end">
                </div>
                
                <div class="filter-group">
                    <label class="filter-label" for="search-filter">Search</label>
                    <input type="text" id="search-filter" placeholder="Search by name, email, ID...">
                </div>
            </div>
            
            <div class="attendance-actions">
                <div class="attendance-count">
                    Showing <span id="record-count">0</span> attendance records
                </div>
               
                <div class="action-buttons">
                    <div class="export-dropdown">
                        <button id="export-excel" class="export-btn excel-btn">
                            <i class="fas fa-file-excel"></i> Export to Excel <i class="fas fa-caret-down"></i>
                        </button>
                        <div class="export-dropdown-content">
                            <a href="#" data-chart-type="bar"><i class="fas fa-chart-bar"></i> Bar Chart</a>
                            <a href="#" data-chart-type="pie"><i class="fas fa-chart-pie"></i> Pie Chart</a>
                            <a href="#" data-chart-type="line"><i class="fas fa-chart-line"></i> Line Chart</a>
                            <a href="#" data-chart-type="none"><i class="fas fa-table"></i> Data Only</a>
                        </div>
                    </div>
                    
                    <button id="export-csv" class="export-btn csv-btn">
                        <i class="fas fa-file-csv"></i> Export to CSV
                    </button>
                    
                    <button id="refresh-data" class="btn-primary">
                        <i class="fas fa-sync-alt"></i> Refresh Data
                    </button>
                    
                    <button id="delete-all-sessions" class="btn-danger">
                        <i class="fas fa-trash"></i> Delete All Sessions
                    </button>
                </div>
            </div>
            
            <div class="attendance-table-container">
                <table class="attendance-table" id="attendance-table">
                    <thead>
                        <tr>
                            <th>Student Name</th>
                            <th>Student ID</th>
                            <th>Email</th>
                            <th>Session</th>
                            <th class="date-column">Date & Time</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="attendance-records">
                        <!-- Records will be populated here -->
                    </tbody>
                </table>
                
                <div class="empty-records" id="empty-records">
                    <i class="fas fa-info-circle"></i> No attendance records found. Check your filters or create a new session.
                </div>
            </div>
            
            <div class="pagination" id="pagination">
                <!-- Pagination buttons will be dynamically generated -->
            </div>
            
            <!-- Status Messages -->
            <div id="status-message" class="status-message"></div>
        </div>
    </main>

    <!-- Footer -->
    <div id="footer"></div>

    <!-- Delete Session Confirmation Modal -->
    <div id="delete-modal" class="modal-overlay">
        <div class="modal-container" role="dialog" aria-labelledby="modal-title" aria-modal="true">
            <div class="modal-header">
                <div class="icon"><i class="fas fa-exclamation-triangle"></i></div>
                <h3 id="modal-title">Delete Session</h3>
            </div>
            <div class="modal-body" id="modal-message">
                Are you sure you want to delete this session? This action cannot be easily undone.
            </div>
            <div id="confirmation-checkbox-container" class="confirmation-checkbox" style="display: none;">
                <input type="checkbox" id="confirmation-checkbox" aria-describedby="modal-message">
                <label for="confirmation-checkbox">I understand this will delete all sessions</label>
            </div>
            <div class="modal-footer">
                <button id="cancel-delete" class="btn-secondary" aria-label="Cancel deletion">Cancel</button>
                <button id="confirm-delete" class="btn-danger" aria-label="Confirm deletion">Delete</button>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification Container -->
    <div class="toast-container" id="toast-container" aria-live="polite"></div>

    <script src="../../js/main.js"></script>
    <script src="../../js/attendance-records.js"></script>
</body>
</html> 